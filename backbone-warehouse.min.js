var __bind=function(n,p){return function(){return n.apply(p,arguments)}},__hasProp={}.hasOwnProperty;
(function(){var n,p,q,v,r,x,w,u,t,l;l=null;w=function(e){return"function"===typeof e};u=function(e){return"undefined"===typeof e};p=function(e,b){var a,c,g,f,m,h,k,d,y;c=e.length;m={};g=function(){var a,k,d,h;a=[];k=d=0;for(h=e.length;0<=h?d<h:d>h;k=0<=h?++d:--d)a.push(m[k]);return b(null,a)};f=function(a){return function(d,h){if(d)return b(d);m[a]=h;if(0===--c)return g()}};y=[];a=k=0;for(d=e.length;k<d;a=++k)h=e[a],y.push(h(f(a)));return y};n=n=function(){function e(b,a){this.fetchOne=__bind(this.fetchOne,
this);null!=a&&(l=a.promise);this.stores={};this.add(b||{})}e.prototype.add=function(b){var a,c;for(a in b)__hasProp.call(b,a)&&(c=b[a],this.stores[a]={store:c,state:"new"})};e.prototype.get=function(b){return this.stores[b].store};e.prototype.keyEvent=function(b){"string"===typeof b&&(b=this.stores[b]);return b.store instanceof Backbone.Collection?"reset":"sync"};e.prototype.fetch=function(b,a,c){var g,f,e;null==b&&(b="");null==a&&(a=!1);w(a)&&(c=a,a=!1);g=this.fetchOne;e=function(b){return function(k){return g(b,
a,k)}};f=function(a){var k,d;if(""===b)return a(null,{});"string"===typeof b&&(b=b.trim().split(/\s+/));d=function(){var a,d,h;h=[];a=0;for(d=b.length;a<d;a++)k=b[a],h.push(e(k));return h}();return p(d,function(d,e){var c,g,f,m;if(d)return a(d,{});g={};c=f=0;for(m=b.length;f<m;c=++f)k=b[c],g[k]=e[c];return a(null,g)})};return u(c)&&l?l(function(a,b){f(function(d,c){return d?b(d):a(c)})}):f(c)};e.prototype.data=function(b,a){null==b&&(b="");null==a&&(a=!1);return this.fetch(b,a)};e.prototype.fetchOne=
function(b,a,c){var g,f=this;null==a&&(a=!1);w(a)&&(c=a,a=!1);g=function(c){var h,k,d;d=f.stores[b];h=f.keyEvent(d);k=function(){d.state="fetching";d.store.once(h,function(){d.state="fetched";return c(null,d.store)});return d.store.fetch({reset:!0,error:c})};switch(d.state){case "new":return k();case "fetched":return a?k():c(null,d.store);case "fetching":return d.store.once(h,function(){if(!a)return c(null,d.store);d.state="fetched";return f.fetchOne(b,!0,c)})}};return u(c)&&l?l(function(a,b){g(function(c,
d){return c?b(c):a(d)})}):g(c)};e.prototype.isFetched=function(b){var a,c,g,f;null==b&&(b="");"string"===typeof b&&(b=b.trim().split(/\s+/));a=!0;g=0;for(f=b.length;g<f;g++)if(c=b[g],"fetched"!==this.stores[c].state){a=!1;break}return a};e.prototype.fetched=function(b){null==b&&(b="");return this.isFetched(b)};e.prototype.fetchAndLoad=function(b,a,c){var g,f,e=this;null==b&&(b="");null==a&&(a=[]);f=[function(a){return e.fetch(b,a)}];if(null!=a&&a.length){if("undefined"===typeof requirejs||null===
requirejs)throw Error("RequireJS is needed but missing");g=function(b){return requirejs(a,function(){return b(null,[].slice.call(arguments,0))})}}else g=function(a){return a(null,[])};f.push(g);return u(c)&&l?l(function(a,b){p(f,function(d,c){return d?b(d):a([c[0]].concat(c[1]))})}):p(f,function(a,b){return c.apply(null,[null,b[0]].concat(b[1]))})};e.prototype.fetchAll=function(b,a){var c,e,f,m,h=this;null==b&&(b=!1);w(b)&&(a=b,b=!1);f=[];m=this.stores||{};for(e in m)__hasProp.call(m,e)&&f.push(e);
c=function(a){return h.fetch(f,b,a)};return u(a)&&l?l(function(a,b){c(function(c,e){return c?b(c):a(e)})}):c(a)};return e}();t={"function":!0,object:!0};q=t[typeof exports]&&exports&&!exports.nodeType&&exports;r=t[typeof module]&&module&&!module.nodeType&&module;v=q&&r&&"object"===typeof global&&global;x=t[typeof window]&&window;t=r&&r.exports===q&&q;v=v||x!==(this&&this.window)&&x||this;return"function"===typeof define&&"object"===typeof define.amd&&define.amd?define("Warehouse",function(){return n}):
q&&r?t?(r.exports=n).Warehouse=n:q.Warehouse=n:v.Warehouse=n})();
