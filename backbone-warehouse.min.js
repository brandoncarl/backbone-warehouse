var __bind=function(n,p){return function(){return n.apply(p,arguments)}},__hasProp={}.hasOwnProperty;
(function(){var n,p,q,v,r,x,w,u,t,m;m=null;w=function(c){return"function"===typeof c};u=function(c){return"undefined"===typeof c};p=function(c,b){var a,l,e,f,k,g,h,d,y;l=c.length;k={};e=function(){var a,h,d,g;a=[];h=d=0;for(g=c.length;0<=g?d<g:d>g;h=0<=g?++d:--d)a.push(k[h]);return b(null,a)};f=function(a){return function(d,g){if(d)return b(d);k[a]=g;if(0===--l)return e()}};y=[];a=h=0;for(d=c.length;h<d;a=++h)g=c[a],y.push(g(f(a)));return y};n=n=function(){function c(b,a){this.fetchOne=__bind(this.fetchOne,
this);null!=a&&(m=a.promise);this.stores={};this.add(b||{})}c.prototype.add=function(b){var a,l;for(a in b)__hasProp.call(b,a)&&(l=b[a],this.stores[a]={store:l,state:"new"})};c.prototype.get=function(b){return this.stores[b].store};c.prototype.keyEvent=function(b){"string"===typeof b&&(b=this.stores[b]);return b.store instanceof Backbone.Collection?"reset":"sync"};c.prototype.fetch=function(b,a,l){var e,f,c;null==b&&(b="");null==a&&(a=!1);w(a)&&(l=a,a=!1);e=this.fetchOne;c=function(b){return function(h){return e(b,
a,h)}};f=function(a){var h,d;if(""===b)return a(null,{});"string"===typeof b&&(b=b.trim().split(/\s+/));d=function(){var a,d,g;g=[];a=0;for(d=b.length;a<d;a++)h=b[a],g.push(c(h));return g}();return p(d,function(d,l){var c,e,f,k;if(d)return a(d,{});e={};c=f=0;for(k=b.length;f<k;c=++f)h=b[c],e[h]=l[c];return a(null,e)})};return u(l)&&m?m(function(a,b){f(function(d,c){return d?b(d):a(c)})}):f(l||function(){})};c.prototype.data=function(b,a){null==b&&(b="");null==a&&(a=!1);return this.fetch(b,a)};c.prototype.fetchOne=
function(b,a,c){var e,f=this;null==a&&(a=!1);w(a)&&(c=a,a=!1);e=function(c){var g,h,d;d=f.stores[b];g=f.keyEvent(d);h=function(){d.state="fetching";d.store.once(g,function(){d.state="fetched";return c(null,d.store)});return d.store.fetch({reset:!0,error:c})};switch(d.state){case "new":return h();case "fetched":return a?h():c(null,d.store);case "fetching":return d.store.once(g,function(){if(!a)return c(null,d.store);d.state="fetched";return f.fetchOne(b,!0,c)})}};return u(c)&&m?m(function(a,b){e(function(c,
d){return c?b(c):a(d)})}):e(c||function(){})};c.prototype.isFetched=function(b){var a,c,e,f;null==b&&(b="");"string"===typeof b&&(b=b.trim().split(/\s+/));a=!0;e=0;for(f=b.length;e<f;e++)if(c=b[e],"fetched"!==this.stores[c].state){a=!1;break}return a};c.prototype.fetched=function(b){null==b&&(b="");return this.isFetched(b)};c.prototype.fetchAndLoad=function(b,a,c){var e,f,k=this;null==b&&(b="");null==a&&(a=[]);f=[function(a){return k.fetch(b,a)}];if(null!=a&&a.length){if("undefined"===typeof requirejs||
null===requirejs)throw Error("RequireJS is needed but missing");e=function(b){return requirejs(a,function(){return b(null,[].slice.call(arguments,0))})}}else e=function(a){return a(null,[])};f.push(e);if(u(c)&&m)return m(function(a,b){p(f,function(c,e){return c?b(c):a([e[0]].concat(e[1]))})});null==c&&(c=function(){});return p(f,function(a,b){return c.apply(null,[null,b[0]].concat(b[1]))})};c.prototype.fetchAll=function(b,a){var c,e,f,k,g=this;null==b&&(b=!1);w(b)&&(a=b,b=!1);f=[];k=this.stores||
{};for(e in k)__hasProp.call(k,e)&&f.push(e);c=function(a){return g.fetch(f,b,a)};return u(a)&&m?m(function(a,b){c(function(c,e){return c?b(c):a(e)})}):c(a||function(){})};return c}();t={"function":!0,object:!0};q=t[typeof exports]&&exports&&!exports.nodeType&&exports;r=t[typeof module]&&module&&!module.nodeType&&module;v=q&&r&&"object"===typeof global&&global;x=t[typeof window]&&window;t=r&&r.exports===q&&q;v=v||x!==(this&&this.window)&&x||this;return"function"===typeof define&&"object"===typeof define.amd&&
define.amd?define("Warehouse",function(){return n}):q&&r?t?(r.exports=n).Warehouse=n:q.Warehouse=n:v.Warehouse=n})();
